# TIL260115 - Form, AJAX


## Form Element

- `<br>`, `<hr>` 같은 / 닫는 태그가 없는 애들은 <br/>처럼 써 주는게 공식인데 안해도 괜찮다

### input / textarea

- `val()` 선택된 요소 값을 가져오거나 새 값 적용

email 입력 폼 실습

```html
  <script>
    // input 박스 처리 코드
    $(document).ready(function(){
        $('#email').on('change', function(){
            var email = $(this).val();
            console.log(email);
        });
    });
  </script>

<!-- html코드 부분 -->
  <label for="email">이메일</label>
  <hr/>
  <input type="text" id="email" placeholder="이메일을 입력해주세요"/>
  <br/>

```

### select

select의 선택된 값을 가져오거나 설정할 수 있고 항목 변경시 다양한 작업 가능

```html
<script>
	// select 처리 부분
  $(document).ready(function(){
      $('#jobs').on('change', function(){
          // jobs 하위 option항목에 필터링 selected를 alert, console
          // alert($('#jobs option:selected').text()); 
          console.log("jobs option: "+$('#jobs option:selected').text())
        });
  });
</script>

<!-- html코드 부분 -->

<label for="jobs">직업</label>
<hr/>
<select id="jobs">
    <option value="0">선택하세요</option>
    <option value="1">회사원</option>
    <option value="2">학생</option>
    <option value="3">교수</option>
</select>
```
### prop

선택한 요소의 상태 속성 값을 가져옴 → 지정해주기도 가능

- 클릭 이벤트가 발생할 때마다 길이를 체크해서 몇 개 까지만 가능하게 한다고 체크할 때 사용할 수 있다
- 전체선택, 해제하는 기능에도 사용 가능

```html
<script>
  // form 처리부분(prop 사용)
  $(document).ready(function(){
    $('#age').on('click', function(){
      var checked = $(this).prop('checked');
      // console.log(checked);
      // 전체선택이면 나머지도 다 체크하기
      if(checked) {
        $('input[type=checkbox][name=age]').prop('checked', true);
      } else {
        $('input[type=checkbox][name=age]').prop('checked', false)
      }
    });
  });
</script>
    
<!-- html코드 부분 -->
    
<div>
  <h5>연령대</h5>
  <label for="age">전체선택/해제</label>
  <input type="checkbox" name="age" id="age" value="0" /><br/>

  <label for="age10">10대</label>
  <input type="checkbox" name="age" id="age10" value="10" checked/>
  <label for="age10">20대</label>
  <input type="checkbox" name="age" id="age20" value="20" />
  <label for="age10">30대</label>
  <input type="checkbox" name="age" id="age30" value="30" />
  <label for="age10">40대</label>
  <input type="checkbox" name="age" id="age40" value="40" checked/>
  <label for="age10">50대</label>
  <input type="checkbox" name="age" id="age50" value="50" />
</div>
```

### attr

attr()로 요소의 속성값을 가져오거나 새로운 값으로 지정 가능

attr을 이용해서 속성을 정의할 수 있고, 객체 리터럴로 정의할 수도 있다.

전송 직전에 속성값을 다시 세팅해서 전송할 경우에 사용한다.

attr에 속성 이름 작성해 값을 읽어 올 수 있다.

<br/>

# AJAX

**AJAX: *Asynchronous Javascript And XML***

**일반적인 HTTP 요청**은 동기 방식으로 진행된다.

- 서버에 Request 요청하면 URL Response를 보내주고 브라우저에서 DOM을 구성해서 사용자가 보게 된다.

- 새로운 내용을 보려면 전체 페이지를 다시 불러와야 한다

**AJAX요청**은 비동기방식으로 진행된다

1. 서버에 AJAX Request하면 서버에서 AJAX Response

2. 응답받아 DOM의 내용을 바꾼다 

- 사용자는 실시간으로 내용이 바뀐다고 느끼게 된다

- 전체 페이지가 아닌 특정 부분에서 데이터를 보내고 받을 수 있는 방식

    - 비동기 방식 → 현재 페이지는 유지하고 새로운 데이터를 불러서 추가

    - 모바일 게시판의 무한 스크롤을 방식이 예시

### ajax 메소드 형식

약속된 틀임

```jsx
$.ajax({
	url:"전송페이지",
	type:"전송방식",
	data:"전송할 데이터",
	dataType:"요청한 데이터 형식",
	success:function(data){
						전송 성공 시 실행될 코드;
	};
	error:function(){
						전송 실패 시 실행될 코드;
	};
});
```

### json

데이터 전달할 때 사용하는 표준 형식

{key-value}가 쌍을 이루고 있는 텍스트 데이터

```json
[
    {”key”:value, “key”:value, “key”:value},
    {”key”:value, “key”:value, “key”:value},
    {”key”:value, “key”:value, “key”:value},
    {”key”:value, “key”:value, “key”:value}
]
```

**가상데이터를 불러와서 table로 가공하여 출력**

```html
<script>
  $(function () {
    $.ajax({
      url: 'sample.json',
      dataType: 'json',
      success: function (data) {
        if (data.length > 0) {
          var tb = $('<table />');
          for (var i in data) {
            var id = data[i].id;
            var first_name = data[i].first_name;
            var last_name = data[i].last_name;
            var email = data[i].email;
            var gender = data[i].gender;
            var row = $('<tr />').append(
              $('<td />').text(id),
              $('<td />').text(first_name),
              $('<td />').text(last_name),
              $('<td />').text(email),
              $('<td />').text(gender)
            );
            tb.append(row);
        }
          $('.wrap').append(tb);
        }
      },
    });
  });
</script>
```