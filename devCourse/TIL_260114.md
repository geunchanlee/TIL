# TIL260114 - jQuery 실습

## jQuery Dom Traversing 예제

클릭 이벤트 DOM 다루기

- `append()` – 선택한 요소의 마지막 위치에 새 요소 추가

- `prepend()` – 선택한 요소의 맨 앞 위치에 새 요소 추가

- `after()` – 선택한 요소의 **다음 위치**에 새 요소 추가

- `before()` – 선택한 요소의 **이전 위치**에 새 요소 추가

### 버튼 클릭 이벤트 다루기

`$(’button’).remove();`

- 버튼을 지움

`$(’button’).on(’click’, function(){ });`

- 버튼을 클릭했을 때 function 실행

요소를 여러 개로 늘렸을 때 버튼을 누르면 모두 다 바뀐다

→ 모든 요소가 button이라는 하나의 스타일을 참조하기 때문에 이렇게 된다.

<br>

`this` 를 사용해보자. 이벤트를 발생시킨 요소를 골라준다!

`$(this).remove();` 로 변경하면 누른 버튼만 사라지는 모습을 볼 수 있다.

`‘this’`처럼 넣으면 this라는 태그를 찾아주기 때문에 this라는 예약어를 사용해야 하는 이런 경우 따옴표 넣지 말기

this로 버튼을 없애고 `$('.vacation').append(price);` 도 this로 바꿔주면 버튼을 눌렀을 때 버튼이 사라지고 문자가 추가되지 않는다. 

→ append로 버튼 뒤에 문자를 추가했는데 그 다음 remove로 지우기 때문에 표시될 요소가 없어짐!

→ append를 after나 before로 바꿔서 선택 요소와 분리시켜주면 의도한 대로 버튼이 사라지고 그 자리에 가격이 표시된다.

<br>

**만약 버튼이 `<div>`태그로 감싸져 있었다면 `<p>price</p>`가 div태그 안으로 들어가게 된다. p엘리먼트를 li요소 안으로 넣고 싶다면?**

1. `$(this).parent().parent().append(price);`
    - 메소드 체이닝을 사용해서 이렇게 해도 되는데 다른 방법이 있다
2.  `$(this).parents(’.vacation’).append(price);`
    - `parents` 를 사용하면 현재 위치의 부모들 중에서 가장 가까운 ‘.vacation’을 찾아준다
3.  `$(this).closest(’.vacation’).append(price);` ✅
    - parents를 사용하면 부모를 모두 다 찾기 때문에 `closest`를 사용해 현재위치에서 가장 가까운 ‘.vacation’을 찾는다. 이 방법이 가장 권장됨

<br>

**가격을 각 상품마다 다르게 하고 싶다면?**

HTML5에 새로 추가된 data속성을 사용하자

`data-key=’value’` 형식으로 사용

`$(’.vacation’).first().data(’price’);`

data-price=’399.99’처럼 넣어둔 요소에 위 코드처럼 접근한다. data-price로 넣지만 접근할 때는 data(’price’)인 부분 주의하기

.data(’<name>’) or .data(<name>, <value>)

```jsx
        $(document).ready(function(){
            $('button').on('click',function(){
                var dollar = $(this).closest('.vacation').data('price');
                var price = $('<p>From $'+dollar+'<p>')
                $(this).closest('.vacation').append(price);
                $(this).remove();
            });
        });
```

dollar 변수에 vacation의 price를 담은 다음 사용할 문자열을 price에 만들어 담고 이 문자열을 이용해준다.

`$(this).closest(’.vacation’)`을 사용해 찾는다.

$(this).closest(’.vacation’)을 두 번 사용하고 있기 때문에 한 번만 연산하기 위해서 위치를 기억하고 다시 사용하자

```jsx
        $(document).ready(function(){
            $('button').on('click',function(){
                var vacation = $(this).closest('.vacation');
                var dollar = vacation.data('price');
                var price = $('<p>From $'+dollar+'<p>')
                vacation.append(price);
                $(this).remove();
            });
        });
```

### 키보드 이벤트 만들기

**티켓 개수를 적으면 가격을 곱해서 보여주기**

티켓 개수를 적는 창과 총 가격 보여주고 적힌 티켓 개수에 가격을 곱해서 업데이트해준다.

`var price = +$(this).closest('.vacation').data('price')` 

**문자열을 숫자로 형 변환**

$ 앞 `+` 는 문자로 넘어온 값을 숫자 자료형으로 바꿔주는 역할

`parseInt()`, `number()`를 사용해서도 변환할 수 있음

```jsx
      $(document).ready(function(){
        $('.vacation').on('keyup', '.quantity', function(){
          // '+'를 앞에 더한 건 문자열을 숫자로 바꾸기 위함 
          var price = +$(this).closest('.vacation').data('price')
          
          // val => input type의 value를 가져와준다
          var qty = +$(this).val();
          
          // 컨텐츠 내용 바꾸는 text를 사용해 구한 값을 곱해서 업데이트
          $('#total').text(price * qty);
        });
      });
```

`on(’keyup’)`으로 키보드 이벤트 발생시마다 작동시킴

`.vacation`의 하위에 있는 `.quantity`요소에 이벤트를 지정한다

- quantity 입력창을 number가 아닌 text로 받아서 처리하는 방식을 사용할 수 있다. (입력 창에 위, 아래 화살표가 표시되지 않게 됨)

- 마우스로 위, 아래 클릭하는 기능을 아예 없애고 직관적으로 따로 표시해주는게 더 좋을 수 있다. 마우스를 호버했을때 위아래 화살표가 표시됨을 사용자는 모를 수 있다. 실제로 다른 사이트들을 보면 별도의 +, - 버튼을 크게 배치한 경우도 많다.

---

### 포커스 이벤트

포커스를 컨트롤하는 이벤트

- `focus()` 선택한 요소에서 포커스가 생성되었을 때 이벤트를 발생하거나 선택한 요소에 강제로 포커스 생성

- `focusin()` 선택한 요소에 포커스가 생성되었을 때 이벤트 발생

- `focusout()` 포커스가 선택한 요소에서 다른 요소로 이동되었을 때 이벤트 발생

- `blur()` 포커스가 선택한 요소에서 다른 요소로 이동되었을 때 이벤트가 발생하거나 선택한 요소의 포커스가 강제로 사라지도록 함

- `change()` 이벤트 대상인 입력 요소의 값이 변경되고, 포커스가 이동하면 이벤트 발생